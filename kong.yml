_format_version: "3.0"

plugins:
  - name: cors
    config:
      origins:
        - http://localhost:5173
        - http://127.0.0.1:5173
      methods:
        - GET
        - POST
        - PUT
        - PATCH
        - DELETE
        - OPTIONS
      headers:
        - Accept
        - Authorization
        - Content-Type
      credentials: true
      max_age: 3600

services:

  - name: federation-service
    url: http://federation-service:4000
    connect_timeout: 10000
    read_timeout: 10000
    write_timeout: 10000
    routes:
      - name: graphql-route
        paths:
          - /graphql
        strip_path: true
        methods:
          - GET
          - POST
          - OPTIONS
        plugins:
          - name: firebase-token-introspect-plugin

  - name: delivery-ws-service
    url: http://delivery-service:8084
    routes:
      - name: ws-route
        paths:
          - /ws
        strip_path: false
        protocols:
          - http
          - https
        preserve_host: true
        plugins:
          - name: firebase-token-introspect-plugin

  - name: elasticsearch-service
    url: http://elasticsearch:9200
    connect_timeout: 10000
    read_timeout: 60000
    write_timeout: 60000
    routes:
      - name: search-route
        paths:
          - /search
        strip_path: true
        methods:
          - GET
          - POST
          - PUT
          - DELETE
          - OPTIONS
        plugins:
          - name: firebase-token-introspect-plugin

